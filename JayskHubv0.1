-- Place this in StarterPlayerScripts

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()

local aimEnabled = false  -- Aimbot/Highlight toggle variable
local isMinimized = false -- Minimized state

-- Function to create the UI
local function createUI()
    -- Create a ScreenGui
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "JayskHubUI"
    screenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")

    -- Create a Frame to hold the title and button
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 200, 0, 150)
    frame.Position = UDim2.new(0, 0, 0, 0)
    frame.BackgroundTransparency = 1
    frame.Visible = true -- Initially, it's visible (non-minimized)
    frame.Parent = screenGui

    -- Create a TextLabel for the title "Jaysk Hub"
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Text = "Jaysk Hub"
    titleLabel.Size = UDim2.new(0, 200, 0, 50)
    titleLabel.Position = UDim2.new(0, 0, 0, 0)
    titleLabel.TextScaled = true
    titleLabel.TextColor3 = Color3.new(1, 1, 1)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Parent = frame

    -- Create a TextLabel to greet the player
    local greetingLabel = Instance.new("TextLabel")
    greetingLabel.Text = "Hello, " .. LocalPlayer.Name .. ", thanks for using Jaysk Hub!"
    greetingLabel.Size = UDim2.new(0, 200, 0, 50)
    greetingLabel.Position = UDim2.new(0, 0, 0, 50)
    greetingLabel.TextScaled = true
    greetingLabel.TextColor3 = Color3.new(1, 1, 1)
    greetingLabel.BackgroundTransparency = 1
    greetingLabel.Parent = frame

    -- Create a toggle button to turn on/off the aimbot and highlight
    local toggleButton = Instance.new("TextButton")
    toggleButton.Text = "Toggle Aimbot: OFF"
    toggleButton.Size = UDim2.new(0, 200, 0, 50)
    toggleButton.Position = UDim2.new(0, 0, 0, 100)
    toggleButton.TextScaled = true
    toggleButton.TextColor3 = Color3.new(1, 1, 1)
    toggleButton.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    toggleButton.Parent = frame

    -- Button click event to toggle the functionality
    toggleButton.MouseButton1Click:Connect(function()
        aimEnabled = not aimEnabled
        toggleButton.Text = "Toggle Aimbot: " .. (aimEnabled and "ON" or "OFF")
    end)

    -- Create a minimized icon (with "jskH")
    local minimizedIcon = Instance.new("TextButton")
    minimizedIcon.Text = "jskH"
    minimizedIcon.Size = UDim2.new(0, 50, 0, 50) -- Smaller size for the minimized icon
    minimizedIcon.Position = UDim2.new(0, 0, 0, 0)
    minimizedIcon.TextScaled = true
    minimizedIcon.TextColor3 = Color3.new(1, 1, 1)
    minimizedIcon.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
    minimizedIcon.Visible = false -- Initially hidden because UI is expanded
    minimizedIcon.Parent = screenGui

    -- Function to minimize the UI
    local function minimizeUI()
        frame.Visible = false -- Hide the main UI
        minimizedIcon.Visible = true -- Show the minimized icon
    end

    -- Function to restore the UI
    local function restoreUI()
        frame.Visible = true -- Show the main UI
        minimizedIcon.Visible = false -- Hide the minimized icon
    end

    -- Clicking the frame's title will minimize the UI
    titleLabel.MouseButton1Click:Connect(function()
        minimizeUI()
    end)

    -- Clicking the minimized icon will restore the UI
    minimizedIcon.MouseButton1Click:Connect(function()
        restoreUI()
    end)
end

-- Function to get the player's head
local function getPlayerHead(player)
    if player.Character and player.Character:FindFirstChild("Head") then
        return player.Character.Head
    end
    return nil
end

-- Function to aim at a player's head
local function aimAtPlayerHead(targetPlayer)
    local head = getPlayerHead(targetPlayer)
    if head then
        -- Continuously track and aim at the player's head
        RunService.RenderStepped:Connect(function()
            if aimEnabled then
                -- Get the player's camera
                local camera = workspace.CurrentCamera
                -- Calculate direction to aim at the player's head
                local aimDirection = (head.Position - camera.CFrame.Position).unit
                -- Set the mouse hit point to aim towards the player's head
                Mouse.Hit = CFrame.new(camera.CFrame.Position, head.Position)
            end
        end)
    end
end

-- Function to create a billboard with the player's username
local function createNameTag(player)
    local character = player.Character
    if character and character:FindFirstChild("Head") then
        local head = character.Head

        -- Create a BillboardGui to display the username above the player's head
        local billboardGui = Instance.new("BillboardGui")
        billboardGui.Adornee = head
        billboardGui.Size = UDim2.new(0, 100, 0, 50) -- Adjust size as necessary
        billboardGui.StudsOffset = Vector3.new(0, 2, 0) -- Adjust the height of the tag
        billboardGui.AlwaysOnTop = true -- Always visible above the head
        billboardGui.Parent = head

        -- Create the TextLabel inside the BillboardGui
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Text = player.Name
        nameLabel.Size = UDim2.new(1, 0, 1, 0)
        nameLabel.TextScaled = true
        nameLabel.BackgroundTransparency = 1
        nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255) -- White text color
        nameLabel.Parent = billboardGui
    end
end

-- Function to create a highlight for a player
local function highlightPlayer(player)
    if player ~= LocalPlayer and aimEnabled then
        -- Wait until the player's character is available
        player.CharacterAdded:Connect(function(character)
            -- Create highlight
            local highlight = Instance.new("Highlight")
            highlight.Parent = character
            highlight.FillColor = Color3.fromRGB(255, 0, 0) -- Red fill color
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255) -- White outline
            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop -- Visible through walls

            -- Start aiming at the player's head
            aimAtPlayerHead(player)

            -- Create name tag
            createNameTag(player)
        end)

        -- Handle case where the character is already loaded
        if player.Character then
            -- Create highlight
            local character = player.Character
            local highlight = Instance.new("Highlight")
            highlight.Parent = character
            highlight.FillColor = Color3.fromRGB(255, 0, 0)
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop -- Visible through walls

            -- Start aiming at the player's head
            aimAtPlayerHead(player)

            -- Create name tag
            createNameTag(player)
        end
    end
end

-- Function to highlight all current players
local function highlightAllPlayers()
    for _, player in pairs(Players:GetPlayers()) do
        highlightPlayer(player)
    end
end

-- Function to remove highlights and name tags
local function clearHighlights()
    for _, player in pairs(Players:GetPlayers()) do
        if player.Character then
            for _, child in pairs(player.Character:GetChildren()) do
                if child:IsA("Highlight") or child:IsA("BillboardGui") then
                    child:Destroy() -- Remove existing highlights and name tags
                end
            end
        end
    end
end

-- Function to refresh the highlights and name tags every 5 seconds
local function refreshPlayers()
    while true do
        -- Clear all current highlights and name tags
        clearHighlights()

        -- Apply new highlights and name tags
        highlightAllPlayers()

        -- Wait 5 seconds before refreshing again
        wait(5)
    end
end

-- Create the UI on game start
createUI()

-- Start refreshing players every 5 seconds
spawn(refresh
